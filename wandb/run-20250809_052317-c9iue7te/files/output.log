[34m[1mwandb[0m: [33mWARNING[0m WandbCallback is deprecated and will be removed in a future release. Please use the WandbMetricsLogger, WandbModelCheckpoint, and WandbEvalCallback callbacks instead. See https://docs.wandb.ai/guides/integrations/keras for more information.
[34m[1mwandb[0m: [33mWARNING[0m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
Epoch 1/10
   2751/Unknown - 53s 17ms/step - loss: 0.4676 - accuracy: 0.7889 - auc: 0.8557INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
/usr/local/lib/python3.11/dist-packages/keras/src/engine/training.py:3079: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Assets written to: /workspace/wandb/run-20250809_052317-c9iue7te/files/model-best/assets
INFO:tensorflow:Assets written to: /workspace/wandb/run-20250809_052317-c9iue7te/files/model-best/assets
[34m[1mwandb[0m: Adding directory to artifact (/workspace/wandb/run-20250809_052317-c9iue7te/files/model-best)... Done. 0.0s

Epoch 1: val_auc improved from -inf to 0.89303, saving model to best_simple.h5
/usr/local/lib/python3.11/dist-packages/keras/src/engine/training.py:3079: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
2751/2751 [==============================] - 66s 22ms/step - loss: 0.4676 - accuracy: 0.7889 - auc: 0.8557 - val_loss: 0.4324 - val_accuracy: 0.8115 - val_auc: 0.8930
Epoch 2/10
2747/2751 [============================>.] - ETA: 0s - loss: 0.4036 - accuracy: 0.8227 - auc: 0.8928INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Assets written to: /workspace/wandb/run-20250809_052317-c9iue7te/files/model-best/assets
INFO:tensorflow:Assets written to: /workspace/wandb/run-20250809_052317-c9iue7te/files/model-best/assets
[34m[1mwandb[0m: Adding directory to artifact (/workspace/wandb/run-20250809_052317-c9iue7te/files/model-best)... Done. 0.0s

Epoch 2: val_auc did not improve from 0.89303
2751/2751 [==============================] - 61s 21ms/step - loss: 0.4037 - accuracy: 0.8227 - auc: 0.8928 - val_loss: 0.4253 - val_accuracy: 0.8100 - val_auc: 0.8814
Epoch 3/10
2750/2751 [============================>.] - ETA: 0s - loss: 0.3741 - accuracy: 0.8366 - auc: 0.9090INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
/usr/local/lib/python3.11/dist-packages/keras/src/engine/training.py:3079: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Assets written to: /workspace/wandb/run-20250809_052317-c9iue7te/files/model-best/assets
INFO:tensorflow:Assets written to: /workspace/wandb/run-20250809_052317-c9iue7te/files/model-best/assets
[34m[1mwandb[0m: Adding directory to artifact (/workspace/wandb/run-20250809_052317-c9iue7te/files/model-best)... Done. 0.0s

Epoch 3: val_auc did not improve from 0.89303
2751/2751 [==============================] - 60s 21ms/step - loss: 0.3741 - accuracy: 0.8366 - auc: 0.9090 - val_loss: 0.4094 - val_accuracy: 0.8179 - val_auc: 0.8919
Epoch 4/10
2749/2751 [============================>.] - ETA: 0s - loss: 0.3568 - accuracy: 0.8450 - auc: 0.9178INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
/usr/local/lib/python3.11/dist-packages/keras/src/engine/training.py:3079: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6afc30e490>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b04064250>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b040c9590>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6b0402fb90>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(3, 3, 3, 16), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d43390>, 135699314520144), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(16,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d5fb10>, 135699284932336), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(36864, 1), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d32d90>, 135700269655392), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Unsupported signature for serialization: ((TensorSpec(shape=(1,), dtype=tf.float32, name='gradient'), <tensorflow.python.framework.func_graph.UnknownArgument object at 0x7b6af8d25dd0>, 135699286594288), {}).
INFO:tensorflow:Assets written to: /workspace/wandb/run-20250809_052317-c9iue7te/files/model-best/assets
INFO:tensorflow:Assets written to: /workspace/wandb/run-20250809_052317-c9iue7te/files/model-best/assets
[34m[1mwandb[0m: Adding directory to artifact (/workspace/wandb/run-20250809_052317-c9iue7te/files/model-best)... Done. 0.0s

Epoch 4: val_auc improved from 0.89303 to 0.89888, saving model to best_simple.h5
/usr/local/lib/python3.11/dist-packages/keras/src/engine/training.py:3079: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
2751/2751 [==============================] - 57s 20ms/step - loss: 0.3568 - accuracy: 0.8449 - auc: 0.9178 - val_loss: 0.4057 - val_accuracy: 0.8214 - val_auc: 0.8989
Epoch 5/10
2747/2751 [============================>.] - ETA: 0s - loss: 0.3437 - accuracy: 0.8514 - auc: 0.9241
Epoch 5: val_auc improved from 0.89888 to 0.90182, saving model to best_simple.h5
2751/2751 [==============================] - 57s 20ms/step - loss: 0.3437 - accuracy: 0.8514 - auc: 0.9241 - val_loss: 0.4089 - val_accuracy: 0.8322 - val_auc: 0.9018
Epoch 6/10
2751/2751 [==============================] - ETA: 0s - loss: 0.3362 - accuracy: 0.8554 - auc: 0.9277
Epoch 6: val_auc did not improve from 0.90182
2751/2751 [==============================] - 59s 21ms/step - loss: 0.3362 - accuracy: 0.8554 - auc: 0.9277 - val_loss: 0.4134 - val_accuracy: 0.8186 - val_auc: 0.8921
Epoch 7/10
2751/2751 [==============================] - ETA: 0s - loss: 0.3270 - accuracy: 0.8605 - auc: 0.9318
Epoch 7: val_auc did not improve from 0.90182
2751/2751 [==============================] - 59s 21ms/step - loss: 0.3270 - accuracy: 0.8605 - auc: 0.9318 - val_loss: 0.4334 - val_accuracy: 0.8131 - val_auc: 0.8904
Epoch 8/10
2747/2751 [============================>.] - ETA: 0s - loss: 0.3206 - accuracy: 0.8631 - auc: 0.9345
Epoch 8: val_auc did not improve from 0.90182
2751/2751 [==============================] - 59s 21ms/step - loss: 0.3206 - accuracy: 0.8631 - auc: 0.9345 - val_loss: 0.4340 - val_accuracy: 0.8160 - val_auc: 0.8846
Epoch 9/10
2746/2751 [============================>.] - ETA: 0s - loss: 0.3134 - accuracy: 0.8669 - auc: 0.9376
Epoch 9: val_auc did not improve from 0.90182
2751/2751 [==============================] - 56s 20ms/step - loss: 0.3134 - accuracy: 0.8669 - auc: 0.9376 - val_loss: 0.4375 - val_accuracy: 0.8174 - val_auc: 0.8930
Epoch 10/10
2750/2751 [============================>.] - ETA: 0s - loss: 0.3064 - accuracy: 0.8701 - auc: 0.9404
Epoch 10: val_auc did not improve from 0.90182
2751/2751 [==============================] - 52s 18ms/step - loss: 0.3064 - accuracy: 0.8701 - auc: 0.9404 - val_loss: 0.5050 - val_accuracy: 0.7844 - val_auc: 0.8781
Simple CNN final metrics: {'loss': 0.3064066171646118, 'accuracy': 0.8701170086860657, 'auc': 0.9404405355453491, 'val_loss': 0.5050058960914612, 'val_accuracy': 0.7844336032867432, 'val_auc': 0.878078043460846}
✔ JPEGs already exist – skipping conversion
✔ TFRecords already complete – skipping write
✔ JPEGs already exist – skipping conversion
✔ TFRecords already complete – skipping write
📄  Saved simple_cnn.csv (57458 rows)
